<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f4f6f9;
      color: #2c3e50;
    }

    /* Sidebar */
    .sidebar {
      position: fixed;
      top: 0; left: 0;
      width: 240px;
      height: 100%;
      background: #2c3e50;
      color: white;
      display: flex;
      flex-direction: column;
      box-shadow: 2px 0 8px rgba(0,0,0,0.1);
    }
    .sidebar h2 {
      text-align: center;
      padding: 20px;
      background: #1a252f;
      margin: 0;
      font-size: 20px;
      letter-spacing: 1px;
    }
    .sidebar a {
      padding: 15px 20px;
      color: #ecf0f1;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: 0.3s;
    }
    .sidebar a:hover, .sidebar a.active {
      background: #34495e;
      color: #1abc9c;
    }
    .sidebar a.logout {
      margin-top: auto;
      background: #e74c3c;
    }
    .sidebar a.logout:hover {
      background: #c0392b;
    }

    /* Top Navbar */
    .topnav {
  margin-left: 240px;
  background: #ffffff;
  border-bottom: 3px solid #3498db20;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px 25px;
  position: sticky;
  top: 0;
  z-index: 1000;
  box-shadow: 0 3px 12px rgba(0,0,0,0.06);
  height: auto; /* Allow breathing space */
}

/* Centered Title */
.nav-title {
  display: flex;
  align-items: center;
  gap: 15px;
  text-align: center;
}

.nav-title i {
  font-size: 36px;
  color: #3498db;
}

.title-text span {
  display: block;
  font-size: 28px;
  font-weight: 800;
  background: linear-gradient(90deg, #3498db, #2ecc71);
  -webkit-background-clip: text;
   background-clip: text;  
  -webkit-text-fill-color: transparent;
  letter-spacing: 1px;
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.title-text small {
  display: block;
  font-size: 15px;
  color: #7f8c8d;
  margin-top: 3px;
  letter-spacing: 0.3px;
}

/* User Info (top-right corner) */
.user-info {
  position: absolute;
  right: 25px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 16px;
  color: #2c3e50;
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 500;
}

    /* Content Area */
    .content {
      margin-left: 240px;
      padding: 30px;
    }
    .tab-section {
      display: none;
    }
    .tab-section.active {
      display: block;
    }

    /* Cards */
    .card {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      margin-bottom: 30px;
    }
    .card h2 {
      margin-bottom: 15px;
      font-size: 22px;
      color: #2c3e50;
    }

    /* Dashboard Stats */
    .stats-container {
      display: flex;
      gap: 25px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .stats-card {
      flex: 1;
      min-width: 250px;
      text-align: center;
      border-radius: 15px;
      padding: 25px;
      color: white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transition: transform 0.3s ease;
    }
    .stats-card:hover {
      transform: translateY(-5px);
    }
    .stats-card h3 {
      margin-bottom: 10px;
      font-size: 20px;
    }
    .stats-card p {
      font-size: 30px;
      margin: 0;
      font-weight: bold;
    }

    /* Tables */
    .table-wrapper {
      overflow-x: auto;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 600px;
    }
    th, td {
      padding: 14px 18px;
      text-align: left;
    }
    th {
      background: #3498db;
      color: white;
      font-size: 15px;
    }
    tr:nth-child(even) {
      background: #f9f9f9;
    }
    tr:hover {
      background: #f1f1f1;
    }
    td a {
      color: #3498db;
      text-decoration: none;
      font-weight: 500;
    }
    td a:hover {
      text-decoration: underline;
    }

    /* Upload Form Styling */
.upload-form {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.upload-form .form-group {
  display: flex;
  flex-direction: column;
}

.upload-form label {
  font-weight: 600;
  margin-bottom: 6px;
  color: #2c3e50;
}

.upload-form input,
.upload-form select {
  padding: 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 15px;
  transition: 0.2s;
}

.upload-form input:focus,
.upload-form select:focus {
  border-color: #3498db;
  outline: none;
  box-shadow: 0 0 4px rgba(52,152,219,0.4);
}

.upload-btn {
  align-self: flex-start;
  padding: 12px 20px;
  background: #3498db;
  border: none;
  color: white;
  font-size: 16px;
  font-weight: 600;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.3s;
}

.upload-btn:hover {
  background: #2980b9;
}

  </style>
  <script>
    function openTab(tabName) {
      let sections = document.querySelectorAll(".tab-section");
      sections.forEach(s => s.classList.remove("active"));
      document.getElementById(tabName).classList.add("active");

      let links = document.querySelectorAll(".sidebar a");
      links.forEach(l => l.classList.remove("active"));
      document.querySelector(`[data-tab="${tabName}"]`).classList.add("active");
    }
  </script>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <h2>Admin Panel</h2>
    <a href="javascript:void(0)" data-tab="dashboard" onclick="openTab('dashboard')" class="active">
      <i class="fa-solid fa-house"></i> Dashboard
    </a>
    <a href="javascript:void(0)" data-tab="upload" onclick="openTab('upload')"><i class="fa-solid fa-upload"></i> Upload PDFs</a>
    <a href="javascript:void(0)" data-tab="materials" onclick="openTab('materials')"><i class="fa-solid fa-book"></i> Study Materials</a>
    <a href="javascript:void(0)" data-tab="users" onclick="openTab('users')"><i class="fa-solid fa-users"></i> Manage Users</a>
    <a href="{% url 'adminlogout' %}" class="logout"><i class="fa-solid fa-right-from-bracket"></i> Logout</a>
  </div>

  <!-- Top Navbar -->
  <div class="topnav">
  <div class="nav-title">
    <i class="fa-solid fa-chart-line"></i>
    <div class="title-text">
      <span>Admin Dashboard</span>
      <small>Manage your platform efficiently</small>
    </div>
  </div>
  <div class="user-info">
    <i class="fa-solid fa-user-circle"></i> {{ user.username }}
  </div>
</div>

  <!-- Main Content -->
  <div class="content">
    
    <!-- Dashboard Section -->
    <div id="dashboard" class="tab-section active">
      <div class="card">
        <h2>Welcome Admin, {{ user.username }} ðŸŽ‰</h2>
        <p style="color:#7f8c8d; margin-top:5px;">You are logged into the admin panel.</p>

        <!-- Dashboard Stats -->
        <div class="stats-container">
          <div class="stats-card" style="background:#3498db;">
            <h3>Total Users</h3>
            <p>{{ user_list|length }}</p>
          </div>
          <div class="stats-card" style="background:#1abc9c;">
            <h3>Study Materials</h3>
            <p>{{ materials|length }}</p>
          </div>
          <div class="stats-card" style="background:#e67e22;">
            <h3>MCQs Extracted</h3>
            <p>{{ mcq_count }}</p>
          </div>
        </div>

        <!-- Quick Actions -->
        <div style="margin-top:30px;">
          <h3 style="margin-bottom:15px;">Quick Actions</h3>
          <div style="display:flex; gap:20px; flex-wrap:wrap;">
            <a href="javascript:void(0)" data-tab="upload" onclick="openTab('upload')" 
               style="flex:1; min-width:200px; background:#2980b9; color:white; text-align:center; 
                      padding:15px; border-radius:10px; text-decoration:none; transition:0.3s;">
              <i class="fa-solid fa-upload"></i> Upload PDFs
            </a>
            <a href="javascript:void(0)" data-tab="materials" onclick="openTab('materials')" 
               style="flex:1; min-width:200px; background:#27ae60; color:white; text-align:center; 
                      padding:15px; border-radius:10px; text-decoration:none; transition:0.3s;">
              <i class="fa-solid fa-book"></i> View Materials
            </a>
            <a href="javascript:void(0)" data-tab="users" onclick="openTab('users')" 
               style="flex:1; min-width:200px; background:#8e44ad; color:white; text-align:center; 
                      padding:15px; border-radius:10px; text-decoration:none; transition:0.3s;">
              <i class="fa-solid fa-users"></i> Manage Users
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Upload PDFs Section -->
    <div id="upload" class="tab-section">
  <div class="card">
    <h2>Upload Study Material</h2>
    <p style="color:#7f8c8d; margin-bottom:20px;">
      Fill in the details below and upload a PDF for study materials.
    </p>

     <style>
  .message-success { color: green; }
  .message-error { color: red; }
</style>

{% if messages %}
  <div>
    {% for message in messages %}
      <p class="{% if message.tags == 'success' %}message-success{% else %}message-error{% endif %}">
        {{ message }}
      </p>
    {% endfor %}
  </div>
{% endif %}

    <form method="post" enctype="multipart/form-data" class="upload-form">
  {% csrf_token %}
  {{ form.non_field_errors }}
  
  <label>{{ form.topic.label }}</label>
  {{ form.topic }}

  <label>{{ form.subtopic.label }}</label>
  {{ form.subtopic }}

  <label>{{ form.difficulty_level.label }}</label>
  {{ form.difficulty_level }}

  <label>{{ form.document.label }}</label>
  {{ form.document }}

  <button type="submit" class="upload-btn">
    <i class="fa-solid fa-plus"></i> Upload
  </button>
</form>
  </div>
</div>

    <!-- Study Materials Section -->
    <div id="materials" class="tab-section">
      <div class="card">
        <h2>Uploaded Study Materials</h2>
        {% if materials %}
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Topic</th>
                  <th>Subtopic</th>
                  <th>Difficulty</th>
                  <th>Document</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                {% for material in materials %}
                <tr>
                  <td>{{ material.topic }}</td>
                  <td>{{ material.subtopic }}</td>
                  <td>{{ material.get_difficulty_level_display }}</td>
                  <td>
                    {% if material.document %}
                      <a href="{{ material.document.url }}" target="_blank">View PDF</a>
                    {% else %}
                      No document
                    {% endif %}
                  </td>
                  <td>
                    <a href="{% url 'delete_material' material.id %}" onclick="return confirm('Are you sure you want to delete this material?');">Delete</a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p>No study materials uploaded yet.</p>
        {% endif %}
      </div>
    </div>

    <!-- Users Section -->
    <div id="users" class="tab-section">
      <div class="card">
        <h2>Registered Users</h2>
        {% if user_list %}
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Username</th>
                  <th>Email</th>
                  <th>Contact</th>
                  <th>Gender</th>
                </tr>
              </thead>
              <tbody>
                {% for u in user_list %}
                <tr>
                  <td>{{ u.username }}</td>
                  <td>{{ u.email }}</td>
                  <td>{{ u.contact }}</td>
                  <td>{{ u.gender }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p>No users registered yet.</p>
        {% endif %}
      </div>
    </div>

  </div>

</body>
</html>